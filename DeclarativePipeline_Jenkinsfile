pipeline {
    agent any

    stages {
        stage('Continuous Download') {
            steps {
                git 'https://github.com/Xclusivep/maven.git'
            }
        }

        stage('Continuous Build') {
            steps {
                sh 'mvn package'
            }
        }

        stage('Push to Nexus') {
            steps {
                // Upload the artifact to Nexus
                nexusPublisher nexusInstanceId: 'nexus-instance', 
                               nexusRepositoryId: 'maven-releases',
                               packages: [
                                   [$class: 'MavenPackage', 
                                    mavenAssetList: [[classifier: '', extension: 'jar', file: 'webapp/target/webapp.war']],
                                    mavenCoordinate: [groupId: 'com.example', artifactId: 'webapp', version: '1.0-SNAPSHOT']]
                               ]
            }
        }
    }

    post {
        success {
            echo 'Build and artifact upload to Nexus successful.'
        }
        failure {
            echo 'Build or artifact upload failed.'
        }
    }
}
